Plan: PDF Image Extraction with Optional Embedding
Add functionality to extract images from imported PDFs and optionally embed them into generated PDF reports with individual image selection, automatic compression, multi-PDF support, and persistent selection state, enabling users to include specific ECG strips, device tracings, and diagnostic charts from manufacturer PDFs in their final reports.

Steps
Create usePdfImageExtractor.ts hook — Build custom hook with state for extractedImages array, isExtracting flag, extractionProgress object with {currentFile, currentIndex, totalFiles}, pageLimit (default 20), implement extractImages(files: File[], pageLimit: number) to process PDFs sequentially with progress updates, enforce 15 image cap showing toast "Maximum images reached (15)" using toast.warning() from sonner, compress images >2MB or >2000px to JPEG at 85% quality, group by source filename with unique IDs (${filename}-page${num}-img${index}), implement toggleImageSelection(imageId), loadMorePages(filename), persist/restore selected IDs from localStorage using draftKey pattern from ReportForm.tsx:151.

Build ImageGallery.tsx component — Create component with props {imagesByFile, onToggleSelection, selectedIds, onLoadMore, hasMorePages, maxImagesReached}, use shadcn/ui Tabs to organize images by source PDF filename with file count badges, responsive grid per tab (grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4), each thumbnail as Card with checkbox overlay (top-right corner with Checkbox from shadcn/ui), Badge showing page number (bottom-left), hover state revealing dimensions and compression indicator, click-to-expand Dialog lightbox with arrow key navigation between images, footer showing global selection counter "X of 15 images selected" with visual indicator when limit reached, "Load More from {filename}" button per tab if hasMorePages.

Add extraction controls to ReportForm.tsx — In ReportForm.tsx:2230-2280 after PdfUploader, add state const [extractedImages, setExtractedImages] = useState<Record<string, ExtractedImage[]>>({}), const [selectedImageIds, setSelectedImageIds] = useState<Set<string>>(new Set()), const [includeImages, setIncludeImages] = useState(false), add "Extract Images" Button with Image icon triggering extraction from pdfManager.files, render shadcn/ui Progress component during extraction showing percentage with toast updates toast.info('Extracting from {filename}... ({current}/{total} files)'), display Badge with counts when extraction completes, add Checkbox labeled "Include selected images in PDF report ({selectedCount}/15)", render collapsible Collapsible wrapping ImageGallery when images exist, sync selectedImageIds to localStorage on changes using useEffect with draftKey.

Create pdfImageExtractor.ts utility — Export ExtractedImage interface {id: string, filename: string, pageNum: number, dataUrl: string, width: number, height: number, format: 'png'|'jpeg', rawBytes: Uint8Array, isCompressed: boolean}, implement extractImagesFromPdf(file: File, startPage: number, endPage: number, onProgress?: (pageNum: number) => void): Promise<ExtractedImage[]> using pdf-lib to load PDF and iterate pages finding XObject images via page.node.Resources(), implement compressImage(dataUrl: string): Promise<{dataUrl: string, rawBytes: Uint8Array, isCompressed: boolean}> using canvas to downscale >2000px images and convert to JPEG at 0.85 quality if >2MB, export extractImagesFromMultiplePdfs(files: File[], pageLimit: number, maxImages: number, onProgress: (current: number, total: number, filename: string) => void): Promise<Record<string, ExtractedImage[]>> enforcing 15 image cap across all files.

Extend ReportForm.tsx:888-915 to embed images — Modify fillReportForm function to accept optional selectedImages: ExtractedImage[] parameter, after generating base report pages check includeImages flag and filter extractedImages by selectedImageIds, add new page with pdfDoc.addPage() containing heading "Image Attachments from Device Reports" using existing font/styling pattern from usePdfFormFiller.ts, group selected images by source filename, render filename subheadings and images in 2-column grid (2 per row), embed each using await pdfDoc.embedPng(image.rawBytes) or embedJpg() based on format, draw with page.drawImage() scaling to max 250x250 maintaining aspect ratio, add text captions "Page {pageNum}" and "(compressed)" indicator below each thumbnail, add new pages as needed when grid fills.

Implementation Notes
Fixed compression settings: 2000px max dimension, 2MB max size, 85% JPEG quality
15 image hard cap across all PDFs with toast warning when limit reached
Progress feedback: Use shadcn/ui Progress bar + sonner toast showing "Extracting from {filename}... ({current}/{total} files)"
localStorage persistence: Save only selected image IDs array, not full image data, keyed by draftKey to avoid quota issues